(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-656be8be"],{"1dce":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"createPost-container"},[a("div",{staticClass:"createPost-main-container"},[a("el-tabs",{attrs:{"tab-position":"left"}},[a("el-tab-pane",{attrs:{label:"基本信息"}},[a("basic-information",{attrs:{"is-edit":t.isEdit}})],1),a("el-tab-pane",{attrs:{label:"图文介绍"}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px","margin-bottom":"5px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v(" 发布 ")])],1),a("Warning"),a("Tinymce",{ref:"editor",attrs:{height:600},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1),a("el-tab-pane",{attrs:{label:"轮播图"}},[a("Carousel")],1)],1)],1)])},i=[],r=a("4d63"),s=(a("b4fb"),a("52c1")),n=a("8256"),l=a("fcac"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v(" 发布 ")])],1),a("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"title"}},[a("MDinput",{attrs:{maxlength:100,name:"name",required:""},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}},[t._v(" 单位名称 ")])],1),a("div",{staticClass:"postInfo-container"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"70px",prop:"title",label:"单位名称"}},[a("el-input",{attrs:{placeholder:"单位名称"},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"70px",label:"法人代表"}},[a("el-select",{attrs:{"remote-method":t.getRemoteUserList,filterable:"","default-first-option":"",remote:"",placeholder:"搜索"},model:{value:t.postForm.author,callback:function(e){t.$set(t.postForm,"author",e)},expression:"postForm.author"}},t._l(t.userListOptions,(function(t,e){return a("el-option",{key:t+e,attrs:{label:t,value:t}})})),1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"70px",label:"联系电话"}},[a("el-input",{attrs:{placeholder:"联系电话"},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{"label-width":"70px",label:"所管公厕"}},[a("el-cascader",{attrs:{options:t.options,props:t.props,clearable:""}}),a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("恢复默认")])],1)],1)],1)],1)],1)],1)],1)},u=[],m=(a("2eeb"),a("053b"),a("1aba")),p=a("828d"),d={status:"draft",title:"",content:"",content_short:"",source_uri:"",image_uri:"",display_time:void 0,id:void 0,platforms:["a-platform"],comment_disabled:!1},f={name:"BasicInformation",components:{MDinput:m["a"]},props:{isEdit:{type:Boolean,default:function(){return!1}}},data:function(){var t=this,e=function(e,a,o){console.log(a),""===a?(t.$message({message:e.field+"为必传项",type:"error"}),o(new Error("必传项"))):o()};return{postForm:Object.assign({},d),rules:{image_uri:[{validator:e}],title:[{validator:e}]},userListOptions:[],props:{multiple:!0},options:[{value:1,label:"莲都区",children:[{value:2,label:"东南镇",children:[{value:3,label:"普陀公厕"},{value:4,label:"黄埔公厕"},{value:5,label:"徐汇公厕"}]}]}],loading:!1}},created:function(){if(this.isEdit){var t=this.$route.params&&this.$route.params.id;this.fetchData(t)}},methods:{fetchData:function(t){var e=this;Object(l["a"])({id:t}).then((function(t){e.postForm=t.data,console.log(t)})).catch((function(t){console.log(t)}))},getRemoteUserList:function(t){var e=this;Object(p["a"])(t).then((function(t){t.data.items&&(e.userListOptions=t.data.items.map((function(t){return t.name})))}))},submitForm:function(){var t=this;this.$refs.postForm.validate((function(e){if(console.log(e),!e)return console.log("error submit!!"),!1;t.loading=!0,t.$notify({title:"成功",message:"发布成功",type:"success",duration:2e3}),t.postForm.status="published",t.loading=!1}))}}},g=f,b=a("cba8"),h=Object(b["a"])(g,c,u,!1,null,null,null),v=h.exports,F=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},_=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("aside",[t._v(" 文章统一要求格式。标题：颜色"),a("span",{staticStyle:{color:"#f39c12"}},[t._v("#f39c12")]),t._v("、字号16px、加粗；副标题：字号14px、加粗；正文：14px、两端对齐；落款12px、颜色#9999a6；每段直接间隔一行，图片主动设置宽高。1级标题：黑体4号字，段前0.5行，段后0.5行；2级标题：宋体加黑，小4号字，段前0.5行，段后0行；3级标题：楷体GB2312,小4号字，Times New Roman; ②正文内容：宋体小4号字，首行缩进，1.5行距。引言和正文凡是引用文献处，应在引用句后括号[]内标明1 2 3,上标。示例为：[1]。 ")])}],w={},x=Object(b["a"])(w,F,_,!1,null,null,null),y=x.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:t.handleCreate}},[t._v(" 新增 ")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"createTime",label:"创建日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"rank",label:"排序"}}),a("el-table-column",{attrs:{label:"图片",width:"400px"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[a("div",{staticClass:"table-image"},[a("el-image",{staticStyle:{width:"100px",height:"77px","margin-right":"10px"},attrs:{src:e.image_uri,"preview-src-list":[e.image_uri]}})],1)]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"remark",label:"备注"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[a("div",[t._v(t._s(o.remark))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleUpdate(o)}}},[t._v(" 编辑 ")]),a("el-button",{attrs:{size:"mini",type:"danger"}},[t._v(" 删除 ")])]}}])})],1),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,"append-to-body":"","close-on-click-modal":!1,width:"570px"},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.changeDialogFormVisible}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,size:"small","label-width":"66px"}},[a("el-form-item",{attrs:{label:"排序",prop:"rank"}},[a("el-input-number",{attrs:{size:"mini",min:1},model:{value:t.form.rank,callback:function(e){t.$set(t.form,"rank",e)},expression:"form.rank"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"请输入"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),a("el-form-item",{attrs:{label:"轮播图",prop:"image_uri"}},[a("Upload",{model:{value:t.form.image_uri,callback:function(e){t.$set(t.form,"image_uri",e)},expression:"form.image_uri"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"text"},on:{click:t.changeDialogFormVisible}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){"create"===t.dialogStatus?t.createData():t.updateData()}}},[t._v(" "+t._s("create"===t.dialogStatus?"创建":"编辑")+" ")])],1)],1)],1)},$=[],O=a("70a2"),j={name:"Carousel",components:{Upload:O["a"]},data:function(){var t=function(t,e,a){e?a():a(new Error("请输入电话号码"))};return{tableLoading:!1,textMap:{update:"编辑",create:"添加"},dialogFormVisible:!1,dialogStatus:"",tableData:[{name:"图1",image_uri:"https://img1.baidu.com/it/u=3001644141,3297622367&fm=26&fmt=auto&gp=0.jpg",rank:1,createTime:"2020-01-23"},{name:"图1",image_uri:"https://element.eleme.cn/static/guide.0a8462c.png",rank:2,createTime:"2020-04-23"},{name:"图1",image_uri:"https://img1.baidu.com/it/u=3001644141,3297622367&fm=26&fmt=auto&gp=0.jpg",rank:3,createTime:"2020-06-23"}],form:{},rules:{title:[{required:!0,message:"请输入名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],image_uri:[{required:!0,message:"必须要上传一张图片",trigger:"blur"}],phone:[{required:!0,trigger:"blur",validator:t}]}}},methods:{changeDialogFormVisible:function(){this.dialogFormVisible=!1,this.resetForm()},handleUpdate:function(t){var e=this;console.log(t),this.form=Object.assign({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["form"].clearValidate()}))},resetForm:function(){this.form={}},handleCreate:function(){this.dialogStatus="create",this.dialogFormVisible=!0},createData:function(){var t=this;this.$refs["form"].validate((function(e){e&&(console.log("创建提交：",t.form),t.$notify({title:"添加成功",message:"添加成功",type:"success",duration:2e3}))}))},updateData:function(){var t=this;this.$refs["form"].validate((function(e){e&&(console.log("将要上传的参数",t.form),t.changeDialogFormVisible(),t.$notify({title:"编辑成功",message:"编辑成功",type:"success",duration:2e3}))}))}}},D=j,C=Object(b["a"])(D,k,$,!1,null,null,null),S=C.exports,V={content:"",id:void 0,comment_disabled:!1},T={name:"ArticleDetail",components:{Tinymce:n["a"],BasicInformation:v,Warning:y,Carousel:S},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t=function(t,e,a){""===e?a(new Error("必传项")):a()};return{postForm:Object.assign({},V),loading:!1,rules:{content:[{validator:t}]},tempRoute:{}}},computed:Object(r["a"])(Object(r["a"])({},Object(s["c"])({needTagsView:function(t){return t.settings.tagsView}})),{},{contentShortLength:function(){return this.postForm.content_short.length},displayTime:{get:function(){return+new Date(this.postForm.display_time)},set:function(t){this.postForm.display_time=new Date(t)}}}),created:function(){if(this.isEdit){var t=this.$route.params&&this.$route.params.id;this.fetchData(t)}this.tempRoute=Object.assign({},this.$route)},methods:{fetchData:function(t){var e=this;Object(l["a"])({id:t}).then((function(t){e.postForm=t.data,console.log(t),e.postForm.title+="   Article Id:".concat(e.postForm.id),e.postForm.content_short+="   Article Id:".concat(e.postForm.id),e.setTagsViewTitle(),e.setPageTitle()})).catch((function(t){console.log(t)}))},submitForm:function(){},setTagsViewTitle:function(){var t="编辑详情",e=Object.assign({},this.tempRoute,{title:"".concat(t,"-").concat(this.postForm.author,"-").concat(this.postForm.id)});this.$store.dispatch("tagsView/updateVisitedView",e)},setPageTitle:function(){var t="编辑详情";document.title="".concat(t," - ").concat(this.postForm.id)},draftForm:function(){0!==this.postForm.content.length&&0!==this.postForm.title.length?(this.$message({message:"保存成功",type:"success",showClose:!0,duration:1e3}),this.postForm.status="draft"):this.$message({message:"请填写必要的标题和内容",type:"warning"})}}},E=T,L=(a("a595"),Object(b["a"])(E,o,i,!1,null,"494bb588",null));e["a"]=L.exports},3123:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var o=a("b775");function i(){return Object(o["a"])({url:"/qiniu/upload/token",method:"get"})}},"828d":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var o=a("b775");function i(t){return Object(o["a"])({url:"/vue-element-admin/search/user",method:"get",params:{name:t}})}},"86ac":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("article-detail",{attrs:{"is-edit":!1}})},i=[],r=a("1dce"),s={name:"CreateCompany",components:{ArticleDetail:r["a"]}},n=s,l=a("cba8"),c=Object(l["a"])(n,o,i,!1,null,null,null);e["default"]=c.exports},a595:function(t,e,a){"use strict";a("dc89")},dc89:function(t,e,a){},fcac:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return r}));var o=a("b775");function i(t){return Object(o["a"])({url:"/getCompanyList",method:"get",params:t})}function r(t){return Object(o["a"])({url:"/getCompanyInfo",method:"get",params:t})}}}]);