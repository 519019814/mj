(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b8a42438"],{"0947":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a("b4fb"),a("e35a"),a("5e9f"),a("bb21"),a("e18c"),a("1c2e"),a("2bbe");Date.prototype.toMidnight=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype.daysAgo=function(e,t){e=e?e-0:0;var a=new Date(this.getTime()-864e5*e);return t?a.toMidnight():a},Date.prototype.monthBegin=function(e){e=e?e-0:0;var t=this.getDate()-1-e;return this.daysAgo(t,!0)},Date.prototype.quarterBegin=function(){var e=this.getMonth()-this.getMonth()%3;return new Date(this.getFullYear(),e,1).toMidnight()},Date.prototype.yearBegin=function(){return new Date(this.getFullYear(),0,1).toMidnight()},Date.prototype.strftime=function(e,t){if(!e){var a=new Date(this.getTime()+288e5).toISOString();return a.substr(0,16).replace("T"," ")}t=t&&t.startsWith("zh")?"zh":"en";var r=function(e,t){var a=t-e.toString().length;return(a&&a>0?"0".repeat(a):"")+e};e=e.replace("%F","%Y-%m-%d"),e=e.replace(/%D|%x/,"%m/%d/%y"),e=e.replace(/%T|%X/,"%H:%M:%S"),e=e.replace("%R","%H:%M"),e=e.replace("%r","%H:%M:%S %p"),e=e.replace("%c","%a %b %e %H:%M:%S %Y");var i=this;return e.replace(/%[A-Za-z%]/g,(function(e){var a=e;switch(e){case"%%":a="%";break;case"%Y":case"%G":a=i.getFullYear();break;case"%y":a=i.getFullYear()%100;break;case"%C":a=i.getFullYear()/100;break;case"%m":case"%n":a=i.getMonth()+1;break;case"%B":t=t.startsWith("en")?"english":t;case"%b":var o=i.getMonth();a=n.monthes[t][o];break;case"%d":case"%e":a=i.getDate();break;case"%j":a=i.getDaysOfYear();break;case"%U":case"%W":var l=i.getWeeksOfYear("%W"===e);a=r(l,2);break;case"%w":a=i.getDay();case"%u":a=0===a?7:a;break;case"%A":t=t.startsWith("en")?"english":t;case"%a":var s=i.getDay();a=n.weekdays[t][s];break;case"%H":case"%k":a=i.getHours();break;case"%I":case"%l":a=i.getHours(),a%=12;break;case"%M":a=i.getMinutes();break;case"%S":a=i.getSeconds();break;case"%s":a=parseInt(i.getTime()/1e3);break;case"%f":var c=i.getMilliseconds();a=r(1e3*c,6);break;case"%P":t=t.startsWith("en")?"english":t;case"%p":var u=i.getHours();a=n.meridians[t][u<12?0:1];break;case"%z":var d=i.getTimezoneOffset(),m=d<0?"-":"+";d=Math.abs(d);var p=r(d/60,2),f=r(d%60,2);a=m+p+f;break;default:break}return"%C"!==e&&"%y"!==e&&"%m"!==e&&"%d"!==e&&"%H"!==e&&"%M"!==e&&"%S"!==e||(a=r(a,2)),a.toString()}))},Date.prototype.humanize=function(e){e=e&&e.startsWith("zh")?"zh":"en";var t=this.strftime("",e),a=(Date.today()-this.toMidnight().getTime())/864e5;if(a<=-10||a>=10)return t;var r=n.dayagos[e],i="";return i=0===a||1===a?r[a]:-1===a?r[2]:a>=2?a+r[3]:a+r[4],i+t.substr(10,6)};var n={monthes:{english:["January","February","March","April","May","June","July","August","September","October","November","December"],en:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],zh:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},weekdays:{english:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],en:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],zh:["日","一","二","三","四","五","六"]},meridians:{english:["a.m.","p.m."],en:["AM","PM"],zh:["上午","下午"]},dayagos:{english:["Today","Yesterday","Tomorrow"," days ago"," days late"],en:["Today","Yesterday","Tomorrow"," days ago"," days late"],zh:["今天","昨天","明天","天前","天后"]}},r=Date,i=[{text:"今天",onClick:function(e){var t=new r((new r).setHours(0,0,0)),a=new r((new r).setHours(23,59,59));e.$emit("pick",[t,a])}},{text:"昨天",onClick:function(e){var t=new r((new r).daysAgo(1).setHours(0,0,0)),a=new r((new r).daysAgo(1).setHours(23,59,59));e.$emit("pick",[t,a])}},{text:"最近一周",onClick:function(e){var t=new r((new r).daysAgo(7).setHours(0,0,0)),a=new r((new r).setHours(23,59,59));e.$emit("pick",[t,a])}},{text:"最近30天",onClick:function(e){var t=new r((new r).daysAgo(30).setHours(0,0,0)),a=new r((new r).setHours(23,59,59));e.$emit("pick",[t,a])}},{text:"这个月",onClick:function(e){var t=new r((new r).monthBegin().setHours(0,0,0)),a=new r((new r).setHours(23,59,59));e.$emit("pick",[t,a])}},{text:"本季度",onClick:function(e){var t=new r((new r).quarterBegin().setHours(0,0,0)),a=new r((new r).setHours(23,59,59));e.$emit("pick",[t,a])}}],o=[{text:"‹ 往前一天 ",onClick:function(e){var t=new r((new r).daysAgo(1).setHours(0,0,0)),a=new r((new r).daysAgo(1).setHours(23,59,59));e.value||(e.value=[t,a]),t=e.value[0].daysAgo(1),a=e.value[1].daysAgo(1),e.$emit("pick",[t,a])}},{text:" 往后一天 ›",onClick:function(e){var t=new r((new r).setHours(0,0,0)),a=new r((new r).setHours(23,59,59));e.value||(e.value=[t,a]),t=e.value[0].daysAgo(-1),a=e.value[1].daysAgo(-1),e.$emit("pick",[t,a])}},{text:"« 往前一周 ",onClick:function(e){var t=new r((new r).setHours(0,0,0)),a=new r((new r).setHours(23,59,59));e.value?e.value=[e.value[0].daysAgo(e.value[0].getDay()),e.value[1].daysAgo(e.value[1].getDay()+1)]:e.value=[t.daysAgo((new r).getDay()),a.daysAgo((new r).getDay()+1)],t=e.value[0].daysAgo(7),a=e.value[1],e.$emit("pick",[t,a])}},{text:" 往后一周 »",onClick:function(e){var t=new r((new r).setHours(0,0,0)),a=new r((new r).setHours(23,59,59));e.value?e.value=[e.value[0].daysAgo(e.value[0].getDay()-7),e.value[1].daysAgo(e.value[1].getDay()-6)]:e.value=[t.daysAgo((new r).getDay()-7),a.daysAgo((new r).getDay()-6)],t=e.value[0],a=e.value[1].daysAgo(-7),e.$emit("pick",[t,a])}}],l=[].concat(i,o)},"09f4":function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),Math.easeInOutQuad=function(e,t,a,n){return e/=n/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function r(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function i(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(e,t,a){var o=i(),l=e-o,s=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=s;var i=Math.easeInOutQuad(c,o,l,t);r(i),c<t?n(e):a&&"function"===typeof a&&a()};u()}},"0f69":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:9,sm:6,md:5,lg:4,xl:4}},[a("div",{staticClass:"filter-container",staticStyle:{"margin-bottom":"0"}},[a("el-input",{staticClass:"filter-item",attrs:{clearable:"",size:"small",placeholder:"输入部门名称搜索","prefix-icon":"el-icon-search"},on:{input:e.handleFilter},model:{value:e.deptName,callback:function(t){e.deptName=t},expression:"deptName"}})],1),a("el-tree",{attrs:{data:e.deptDatas,props:e.defaultProps,"expand-on-click-node":!0},on:{"node-click":e.handleNodeClick}})],1),a("el-col",{attrs:{xs:15,sm:18,md:19,lg:20,xl:20}},[a("div",{staticClass:"filter-container"},[a("div",[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",size:"small",placeholder:"输入名称或者邮箱搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.title,callback:function(t){e.$set(e.listQuery,"title",t)},expression:"listQuery.title"}}),a("date-range-picker",{staticClass:"filter-item",model:{value:e.listQuery.createTime,callback:function(t){e.$set(e.listQuery,"createTime",t)},expression:"listQuery.createTime"}}),a("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{clearable:"",size:"small",placeholder:"状态"},on:{change:e.handleFilter},model:{value:e.listQuery.enabled,callback:function(t){e.$set(e.listQuery,"enabled",t)},expression:"listQuery.enabled"}},e._l(e.enabledTypeOptions,(function(e){return a("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})})),1),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"mini",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(" 搜索 ")]),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",icon:"el-icon-delete"},on:{click:e.resetListQuery}},[e._v(" 重置 ")])],1)]),a("div",{staticClass:"curd"},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v(" 添加 ")]),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:e.resetListQuery}},[e._v(" 删除 ")])],1),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"append-to-body":"","close-on-click-modal":!1,width:"570px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{inline:!0,model:e.form,rules:e.rules,size:"small","label-width":"66px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",e._n(t))},expression:"form.phone"}})],1),a("el-form-item",{attrs:{label:"昵称",prop:"nickName"}},[a("el-input",{model:{value:e.form.nickName,callback:function(t){e.$set(e.form,"nickName",t)},expression:"form.nickName"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("el-form-item",{attrs:{label:"部门",prop:"dept.id"}},[a("treeselect",{staticStyle:{width:"178px"},attrs:{options:e.deptDatas,placeholder:"选择部门"},model:{value:e.form.dept.id,callback:function(t){e.$set(e.form.dept,"id",t)},expression:"form.dept.id"}})],1),a("el-form-item",{attrs:{label:"性别"}},[a("el-radio-group",{model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[a("el-radio",{attrs:{label:"男"}},[e._v("男")]),a("el-radio",{attrs:{label:"女"}},[e._v("女")])],1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"角色",prop:"roles"}},[a("el-select",{staticStyle:{width:"437px"},attrs:{multiple:"",placeholder:"请选择"},on:{"remove-tag":e.deleteTag,change:e.changeRole},model:{value:e.selRoleDatas,callback:function(t){e.selRoleDatas=t},expression:"selRoleDatas"}},e._l(e.roleDatas,(function(t){return a("el-option",{key:t.name,attrs:{disabled:1!==e.level&&t.level<=e.level,label:t.name,value:t.id}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"text"},on:{click:e.changeDialogFormVisible}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v(" "+e._s("create"===e.dialogStatus?"创建":"编辑")+" ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.userTableData},on:{"selection-change":e.selectionChangeHandler}},[a("el-table-column",{attrs:{selectable:e.checkboxT,type:"selection"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"name",label:"用户名"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"nickName",label:"昵称"}}),a("el-table-column",{attrs:{prop:"gender",label:"性别"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"phone",label:"电话"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"email",label:"邮箱"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"dept",label:"部门"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.dept.name))])]}}])}),a("el-table-column",{attrs:{label:"状态",align:"center",prop:"enabled"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:e.user.id===t.row.id,"active-color":"#409EFF","inactive-color":"#F56C6C"},on:{change:function(a){return e.changeEnabled(t.row,t.row.enabled)}},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"scope.row.enabled"}})]}}])},[a("template",{slot:"header"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"禁用后该账号将不可登录，但保留数据",placement:"right"}},[a("div",[e._v("状态"),a("i",{staticClass:"el-icon-warning-outline"})])])],1)],2),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"createTime",label:"创建日期"}}),a("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate(n)}}},[e._v(" 编辑 ")]),a("el-button",{attrs:{size:"mini",type:"danger"}},[e._v(" 删除 ")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getUsers}})],1)],1)],1)},r=[],i=a("9d6b"),o=a("4d63"),l=(a("08ba"),a("ea69"),a("e186"),a("52c1")),s=a("c24f"),c=a("fe05"),u=a("333d"),d=a("7d66"),m=a.n(d),p=(a("5166"),a("b99f")),f=a("cc5e"),g=[],b=[],h={name:"User",components:{Pagination:u["a"],DateRangePicker:p["a"],Treeselect:m.a},data:function(){var e=function(e,t,a){t?a():a(new Error("请输入电话号码"))};return{listQuery:{page:1,limit:20,title:void 0,type:void 0,sort:"-id",id:void 0,pid:void 0,area:void 0,time:void 0,createTime:void 0},deptDatas:[],deptName:"",textMap:{update:"编辑",create:"添加"},dialogFormVisible:!1,dialogStatus:"",form:{id:null,username:null,nickName:null,gender:"男",email:null,enabled:"false",roles:[],jobs:[],dept:{id:null},phone:null},roles:[],level:3,tableLoading:!1,userTableData:[],total:0,depts:[],jobs:[],roleDatas:[],selRoleDatas:[],defaultProps:{children:"children",label:"name",isLeaf:"leaf"},enabledTypeOptions:[{key:"true",display_name:"激活"},{key:"false",display_name:"锁定"}],rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],nickName:[{required:!0,message:"请输入用户昵称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],phone:[{required:!0,trigger:"blur",validator:e}]}}},computed:Object(o["a"])({},Object(l["b"])(["user"])),created:function(){this.getUsers(),this.getDeptDatas(),this.getRoles()},methods:{getUsers:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,Object(s["b"])(e.listQuery);case 3:a=t.sent,e.userTableData=a.data.list,e.total=a.data.total,e.tableLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},getRoles:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["c"])();case 2:a=t.sent,e.roleDatas=a.data;case 4:case"end":return t.stop()}}),t)})))()},handleFilter:function(){this.listQuery.page=1,this.getUsers()},getDeptDatas:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["a"])(e.listQuery);case 2:a=t.sent,e.deptDatas=a.data.list;case 4:case"end":return t.stop()}}),t)})))()},handleCreate:function(){this.resetForm(),this.dialogStatus="create",this.dialogFormVisible=!0},createData:function(){var e=this;this.$refs["form"].validate((function(t){t&&(console.log("创建提交：",e.form),e.$notify({title:"添加成功",message:"添加成功",type:"success",duration:2e3}))}))},handleUpdate:function(e){var t=this;this.form=Object.assign({},e),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["form"].clearValidate()}))},updateData:function(){var e=this;this.$refs["form"].validate((function(t){t&&(console.log("将要上传的参数",e.form),e.changeDialogFormVisible(),e.$notify({title:"编辑成功",message:"编辑成功",type:"success",duration:2e3}))}))},changeDialogFormVisible:function(){this.dialogFormVisible=!1,this.resetForm()},resetForm:function(){this.form={id:null,username:null,nickName:null,gender:"男",email:null,enabled:"false",roles:[],jobs:[],dept:{id:null},phone:null}},resetListQuery:function(){this.listQuery={page:1,limit:20,title:void 0,type:void 0,sort:"-id",id:void 0,pid:void 0,area:void 0,time:void 0,createTime:void 0}},selectionChangeHandler:function(){console.log("selectionChangeHandler")},checkboxT:function(e,t){return e.id!==this.user.id},changeRole:function(e){console.log("选择了角色:",e)},changeJob:function(e){b=[],e.forEach((function(e,t){var a={id:e};b.push(a)}))},deleteTag:function(e){g.forEach((function(t,a){t.id===e&&g.splice(a,e)}))},handleNodeClick:function(e){console.log("此处更新table",e),0===e.pid?this.listQuery.deptId=null:this.listQuery.deptId=e.id,this.handleFilter()},changeEnabled:function(e,t){console.log(e,t),t||this.$confirm('此操作将 禁用"<span style="color: red">'.concat(e.nickName,'</span>"账号, 是否继续？'),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0})},getJobs:function(){},getRoleLevel:function(){}}},v=h,y=(a("1d09"),a("cba8")),w=Object(y["a"])(v,n,r,!1,null,"385f93da",null);t["default"]=w.exports},"1d09":function(e,t,a){"use strict";a("d0af")},cc5e:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"b",(function(){return s}));var n=a("b775");function r(){return Object(n["a"])({url:"/vue-element-admin/routes",method:"get"})}function i(){return Object(n["a"])({url:"/vue-element-admin/roles",method:"get"})}function o(e){return Object(n["a"])({url:"/vue-element-admin/role",method:"post",data:e})}function l(e,t){return Object(n["a"])({url:"/vue-element-admin/role/".concat(e),method:"put",data:t})}function s(e){return Object(n["a"])({url:"/vue-element-admin/role/".concat(e),method:"delete"})}},d0af:function(e,t,a){},fe05:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("b775");function r(e){return Object(n["a"])({url:"/getDept",method:"get",params:e})}}}]);